import{k as I,r as p,j as e,S as R,i as E,f as y,q as K,G as B,T as q,e as pe,eo as fe,dB as xe,l as ue,dC as je,ep as be,eq as Se,ej as D,ea as De,m as Ce,p as ge,H as Ae}from"./index-w2TjI0MF.js";import{C as Ne}from"./custom-breadcrumbs-RjSW2biQ.js";import{i as We}from"./format-time-gLo4N_aV.js";import{F as ye}from"./file-data-activity-G1s9bg5w.js";import{b as Te,N as Me}from"./neoVerify-p4WSaM1h.js";import{D as J}from"./DatePicker-fnQuhWtt.js";import{f as we}from"./TextField-Rnx-roig.js";import{E as O}from"./empty-content-euVssf39.js";import{u as Y}from"./use-table-q5zAdmxy.js";import"./table-pagination-custom-Q_T7ptyt.js";import{A as Q,a as X,b as L}from"./AccordionDetails-BGr6frgm.js";import{T as G,a as V,d as T,c,b as C}from"./TableHead-YLlfzKMZ.js";import{T as t}from"./TableCell-Fp4KwiAp.js";import{a as ve,b as Fe,c as ke,d as Ie,e as Pe,f as Re,i as Oe,j as Ee,k as Be,l as Ye}from"./report-table-row-YCyFeH4Z.js";import{u as P,w as Ge}from"./xlsx-_hdJyjoG.js";import{C as W}from"./Card-huoyhVY-.js";import{D as Ve}from"./DialogContent-ITde-Yrn.js";import{B as Z}from"./Button-craGvtks.js";import{D as $e}from"./DataGrid-dgsGCI5B.js";import{G as He,a as ze}from"./GridToolbarColumnsButton-MIv13JiJ.js";import"./index-q81m-9gd.js";import"./use-chart-SwzRfhpe.js";import"./CardHeader-1ocrqUuB.js";import"./DialogActions-UxlkhUlJ.js";import"./ListItem-egfm1Owt.js";import"./isMuiElement-c8Cd3wTs.js";import"./Chip-xwffwAcK.js";import"./Select-fj7_ZCHL.js";import"./Checkbox-MPmUmIhR.js";import"./SwitchBase-0oakK23s.js";import"./TablePagination-cyjZ-mNp.js";import"./KeyboardArrowRight-IzA2QHP7.js";import"./FirstPage-R9DouRzM.js";import"./FormControlLabel-i471xspq.js";import"./Switch-uNCmthE_.js";import"./Box-wOnCFSTh.js";import"./Stack-_q8zbVdT.js";import"./dialogTitleClasses-DEvrnnr4.js";import"./Autocomplete-zVr0giqp.js";import"./Close-f2MhZoYf.js";import"./ClickAwayListener--d0jk-Rq.js";import"./Skeleton-t3WH1W5x.js";import"./CircularProgress-DldaBh_H.js";function ee({filters:o,onFilters:r,dateError:d}){const l=p.useCallback(x=>{r("startDate",x)},[r]),g=p.useCallback(x=>{r("endDate",x)},[r]);return e.jsx(e.Fragment,{children:e.jsxs(R,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(J,{label:"Start date",value:o.startDate,onChange:l,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(J,{label:"End date",value:o.endDate,onChange:g,slotProps:{textField:{fullWidth:!0,error:d}},sx:{maxWidth:{md:200},[`& .${we.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}ee.propTypes={dateError:I.bool,filters:I.object,onFilters:I.func};const _e=({neoAppDataSummaryPercents:o})=>{const r=Y();return e.jsx(E,{sx:{width:"100%"},children:e.jsxs(Q,{children:[e.jsx(X,{expandIcon:e.jsx(y,{icon:"ooui:expand"}),"aria-controls":"panel1-content",id:"panel1-header",sx:{fontWeight:"bold"},children:"Neo Status"}),e.jsx(L,{children:e.jsx(K,{children:e.jsx(G,{component:B,children:e.jsxs(V,{size:r.dense?"small":"medium",children:[e.jsx(T,{children:e.jsxs(c,{children:[e.jsx(t,{children:"Status"}),e.jsx(t,{align:"left",children:"Neo Status"}),e.jsx(t,{align:"center"})]})}),e.jsxs(C,{children:[e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Working"}),e.jsx(t,{children:"Active, Application Submitted, Appointment Set, Fresh (within 30 days), Pending, Underwriting Ready"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Approved"}),e.jsx(t,{children:"Dead, Sold, Sold - Outside Finan, Sold & Verified (if sold date or DMS Id not there)"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Ignored"}),e.jsx(t,{children:"Duplicate-Ignore, Fresh (Older than 30 days)"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Sold"}),e.jsx(t,{children:"Sold, Sold - Outside Finan, Sold & Verified (Sold Date and DMS Id should be there)"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Rejected"}),e.jsx(t,{children:"Rejected, Fresh (Older than 30 days)"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Other"}),e.jsx(t,{children:"Application Ready, Approved - Not Sold, Assign Salesperson, Charged Off, Conditional Approval, Incomplete, Low Balance, Review"})]})]})]})})})})]})})},Ue=({loading:o,totalCount:r,tableDataStatuswise:d,seriesLabel:l,handleRefreshPage:g,permission:x})=>{const i=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:n=>e.jsx(ve,{params:n})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Fe,{params:n})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(ke,{params:n})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Ie,{params:n})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Pe,{params:n})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Re,{params:n})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Oe,{params:n})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Ee,{params:n})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Be,{params:n})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:n=>e.jsx(Ye,{params:n})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],M=()=>{let n="";l!=null&&l.seriesName?n=`${l.seriesName}-${l.searchStartDate}-TO-${l.searchEndDate}.xlsx`:n=`All Data - ${l==null?void 0:l.searchStartDate}-TO-${l==null?void 0:l.searchEndDate}.xlsx`;const f=i.map(N=>N.headerName),w=d.map(N=>i.map(k=>N[k.field])),v=[f,...w],F=P.aoa_to_sheet(v),A=P.book_new();P.book_append_sheet(A,F,"Sheet1"),Ge(A,n),pe("Download successful."),handleClose(!1)};return e.jsx(e.Fragment,{children:e.jsxs(W,{children:[e.jsx(Ve,{sx:{maxWidth:"100%",height:500},children:e.jsx($e,{rowCount:r,rows:d,columns:i,loading:o,paginationMode:"server",pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0,slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(He,{children:[e.jsxs(q,{variant:"h6",children:[l!=null&&l.seriesName?l==null?void 0:l.seriesName:"All Data"," : ",l==null?void 0:l.searchStartDate," To ",l==null?void 0:l.searchEndDate,"   "]}),e.jsxs(R,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[(x==null?void 0:x.IsExport)&&e.jsx(Z,{variant:"contained",color:"primary",onClick:M,startIcon:e.jsx(y,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(Z,{variant:"outlined",startIcon:e.jsx(y,{icon:"material-symbols:refresh"}),onClick:g,children:"Refresh"}),e.jsx(ze,{})]})]})}),noRowsOverlay:()=>e.jsx(O,{title:"No Data"}),noResultsOverlay:()=>e.jsx(O,{title:"No results found"})}})}),e.jsx(R,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(q,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",r]})})]})})},qe=({neoAppDataSummaryPercents:o})=>{const r=Y();return e.jsx(E,{sx:{width:"100%"},children:e.jsx(G,{component:B,children:e.jsxs(V,{size:(r.dense,"small"),children:[e.jsx(T,{children:e.jsxs(c,{children:[e.jsx(t,{children:"Neo AppData Summary Percents"}),o.map((d,l)=>e.jsx(t,{children:d.monthName},l))]})}),e.jsxs(C,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Book To Look"}),o.map((d,l)=>e.jsxs(t,{children:[d.bookToLookPercentage," %"]},l))]}),e.jsxs(C,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Book To Approved"}),o.map((d,l)=>e.jsxs(t,{children:[d.bookToApprovedPercentage," %"]},l))]}),e.jsxs(C,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Approved"}),o.map((d,l)=>e.jsxs(t,{children:[d.approvedPercentage," %"]},l))]})]})})})},Je=({neoAppDataSummaryPercents:o})=>{const r=Y();return e.jsx(E,{sx:{width:"100%"},children:e.jsxs(Q,{children:[e.jsx(X,{expandIcon:e.jsx(y,{icon:"ooui:expand"}),"aria-controls":"panel1-content",id:"panel1-header",sx:{fontWeight:"bold"},children:"Neo Summary Percents formulas"}),e.jsx(L,{children:e.jsx(K,{children:e.jsx(G,{component:B,children:e.jsxs(V,{size:r.dense?"small":"medium",children:[e.jsx(T,{children:e.jsxs(c,{children:[e.jsx(t,{children:"Status"}),e.jsx(t,{align:"left",children:"Neo Status"}),e.jsx(t,{align:"center"})]})}),e.jsxs(C,{children:[e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Incomplete Applications"}),e.jsx(t,{children:"Active,Application Submitte,Appointment Set,Assign Salesperson,Charged Off,Fresh,Incomplete,Pending,Underwriting Ready,Working"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Apps Approved Not Funded/Sold"}),e.jsx(t,{children:"Approved,Approved - Not Sold,Conditional Approval,Dead,Lost"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Apps Funded/Sold"}),e.jsx(t,{children:"Sold,Sold - Outside Finan,Sold & Verified"})]})]}),e.jsx(T,{children:e.jsxs(c,{children:[e.jsx(t,{}),e.jsx(t,{align:"left",children:"Formulas"}),e.jsx(t,{align:"center"})]})}),e.jsxs(C,{children:[e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Book To Look "}),e.jsx(t,{children:"FundedOrSoldApplications * 100.0 / TotalApplications"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Book To Approved"}),e.jsx(t,{children:"FundedOrSoldApplications * 100.0 / (FundedOrSoldApplications + AppsApprovedNotSold)"})]}),e.jsxs(c,{children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Approved"}),e.jsx(t,{children:"(FundedOrSoldApplications + AppsApprovedNotSold) * 100.0 / (TotalApplications - IncompleteApplications)"})]})]})]})})})})]})})},Ze={search:"",startDate:fe(),endDate:new Date},Ke=()=>{const o=xe();ue();const{user:r}=p.useContext(je),[d,l]=p.useState(!0),[g,x]=p.useState(!1),[i,M]=p.useState(Ze),n=We(i.startDate,i.endDate),[f,w]=p.useState([]),[v,F]=p.useState([]),[A,N]=p.useState(Array);p.useState(!1);const[k,te]=p.useState(0),[ae,$]=p.useState(),[le,se]=p.useState({IsAudit:!1,IsExport:!1,IsPrint:!1});p.useEffect(()=>{d&&(ie(),ne(),z())},[d]);const ne=async()=>{const a={UserTypeID:r==null?void 0:r.UserTypeID},{result:s,status:m}=await be(a);if(m){let h=Se(s,"Monthly Status Wise Summary");se(h)}},ie=async()=>{var u;const a={searchStartDate:D(i.startDate),searchEndDate:D(i.endDate),search:i.search},{result:s,isLoading:m}=await Te(a),h=((u=s==null?void 0:s.neoAppDataStatusWiseSummary)==null?void 0:u.map((j,b)=>({...j,id:b})))||[];N(s==null?void 0:s.neoAppDataSummaryPercents),w(h),l(m)},H=async a=>{const{result:s,isLoading:m}=await Me(a),h=(s==null?void 0:s.map((u,j)=>({...u,id:j})))||[];te(h==null?void 0:h.length),F(h),x(m)},re=p.useCallback((a,s)=>{M(m=>({...m,[a]:s})),l(!0)},[]),oe={labels:f==null?void 0:f.map(a=>[a.monthYear,`Total : ${a.totalApplications}`]),colors:[o.palette.primary.main,o.palette.error.main,o.palette.warning.main,o.palette.text.disabled],series:[{type:"Month",data:[{name:"Working Applications",data:f==null?void 0:f.map(a=>a.workingApplications)},{name:"Approved Applications",data:f.map(a=>a.approvedApplications)},{name:"Ignored Application",data:f.map(a=>a.ignoredApplications)},{name:"Rejected Application",data:f.map(a=>a.rejectedApplications)},{name:"Sold Application",data:f.map(a=>a.soldApplications)},{name:"Other Applications",data:f.map(a=>a.otherApplications)}],options:{}}]},de=(a,s)=>{a=a+1,s=+("20"+s);const m=i.startDate.getFullYear(),h=i.startDate.getMonth()+1,u=i.endDate.getFullYear(),j=i.endDate.getMonth()+1;console.log("1  start ---> ",{startYear:m,startMonth:h}),console.log("2 end ---> ",{endYear:u,endMonth:j}),console.log("3 end ---> ",{month:a,year:s});let b="",S="";return a===h&&s===m&&a===j&&s===u?(b=i.startDate,S=i.endDate):a===h&&s===m?(b=i.startDate,S=new Date(s,a,0)):a===j&&s===u?(b=new Date(s,a-1,1),S=i.endDate):(b=new Date(s,a-1,1),S=new Date(s,a,0)),{startDate:b,endDate:S}},ce=async a=>{x(!0);const{label:s,seriesName:m}=a,h=s?s==null?void 0:s.split(" ")[0]:null,u=s?s==null?void 0:s.split(" ")[1]:null,j=m?m.split(" ")[0]:null;if(h){const b=u?parseInt(u,10):new Date().getFullYear(),_={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[h],{startDate:me,endDate:he}=de(_,b);if(_!==void 0){const U={searchStartDate:D(me),searchEndDate:D(he),status:j,seriesName:m,search:""};$(U),await H(U)}else console.log("Invalid month label")}},z=async()=>{const a={searchStartDate:D(i.startDate),searchEndDate:D(i.endDate),status:"",search:""};$(a),x(!0),await H(a)};return e.jsx(e.Fragment,{children:d?e.jsx(De,{}):e.jsxs(Ce,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(Ne,{heading:"Monthly Status Wise Summary",links:[{name:"Dashboard",href:ge.dashboard.root},{name:"Monthly Status Wise Summary"}],sx:{mb:{xs:3,md:3}}}),e.jsx(ee,{filters:i,dateError:n,onFilters:re}),f.length>0?e.jsx(ye,{title:"",chart:oe,handleChartClick:ce}):e.jsx(O,{title:"No Data"}),e.jsx(W,{sx:{mb:2,marginTop:"20px"},children:e.jsx(_e,{})}),A&&e.jsx(W,{sx:{mb:3,marginTop:"20px"},children:e.jsx(qe,{neoAppDataSummaryPercents:A})}),e.jsx(W,{sx:{mb:2,marginTop:"20px"},children:e.jsx(Je,{})}),e.jsx(Ue,{permission:le,loading:g,handleRefreshPage:z,totalCount:k,seriesLabel:ae,tableDataStatuswise:v})]})})},Qe=Ke;function $t(){return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{children:e.jsx("title",{children:"Neo Verify | Monthly Status Wise Summary"})}),e.jsx(Qe,{})]})}export{$t as default};
