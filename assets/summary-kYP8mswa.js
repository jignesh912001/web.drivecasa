import{k as I,r as o,j as e,S as v,i as k,f as A,t as be,K as Ce,W as De,T as F,q as P,d as je,e as V,e9 as Ne,l as Se,d_ as We,m as ge,p as Me,H as ye}from"./index-1p47eBME.js";import{C as we}from"./custom-breadcrumbs-ejdItUPy.js";import{i as Ae}from"./format-time-u79TBH4b.js";import{b as Te,f as W}from"./Common-6TZMDS_T.js";import{F as ve}from"./file-data-activity-JV-bsJDD.js";import{b as Fe,N as Ie}from"./neoVerify-CLMkHAFC.js";import{D as H}from"./DatePicker-BzM8vAdR.js";import{f as ke}from"./TextField-icBS-xTH.js";import{E as R}from"./empty-content-0I8dksI7.js";import{u as Pe}from"./use-table-bJ2QhhA9.js";import{f as Re,a as j}from"./table-pagination-custom-eylB-Ga1.js";import{A as Ee,a as Oe,b as Ye}from"./AccordionDetails-K2AlO5n2.js";import{T as _e,a as Be,b as Ge}from"./TableContainer-SfTtgxuR.js";import{T as d}from"./TablePagination-cYgHTpEI.js";import{a as $,b as Z,c as z,d as J,e as q,f as K,i as U,j as Q,k as X,l as L}from"./report-table-row-_NilG2hE.js";import{u as g,w as ee}from"./xlsx-_hdJyjoG.js";import{D as He}from"./DialogTitle-mxKiGRY-.js";import{D as ae}from"./DialogContent-ZLGfbZeW.js";import{D as le}from"./DataGrid-bam2EM9g.js";import{C as te}from"./Card-ZB6BdyFv.js";import{G as Ve,a as $e}from"./GridToolbarColumnsButton-l-1G7gOE.js";import"./index-q81m-9gd.js";import"./use-chart-YjyUlaSy.js";import"./CardHeader-eNxm5LNN.js";import"./index-LN_iJjRn.js";import"./DialogActions-6leSuHgX.js";import"./ListItem-3gpHZ7x8.js";import"./Chip-T2QdivAc.js";import"./Select-CkmgtMGF.js";import"./Checkbox-1dGsy0Fk.js";import"./SwitchBase-KtF9q-fS.js";import"./FormControlLabel-MfjBOrpQ.js";import"./Switch---bTYswk.js";import"./KeyboardArrowRight-I6o-NnvC.js";import"./FirstPage-G8qrJftQ.js";import"./Box-Cz5Hjvgy.js";import"./Stack-AIclp7uD.js";import"./dialogTitleClasses-0gQIm9Ko.js";import"./Autocomplete-hskIkUhs.js";import"./Close-hmHQgjPk.js";import"./ClickAwayListener-KCtbYRFC.js";import"./Skeleton-Jih7rqwS.js";import"./CircularProgress-9T2H3_E5.js";function ie({filters:u,onFilters:s,dateError:c}){const i=o.useCallback(r=>{s("startDate",r)},[s]),p=o.useCallback(r=>{s("endDate",r)},[s]);return e.jsx(e.Fragment,{children:e.jsxs(v,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(H,{label:"Start date",value:u.startDate,onChange:i,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(H,{label:"End date",value:u.endDate,onChange:p,slotProps:{textField:{fullWidth:!0,error:c}},sx:{maxWidth:{md:200},[`& .${ke.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}ie.propTypes={dateError:I.bool,filters:I.object,onFilters:I.func};const Ze=({neoAppDataSummaryPercents:u})=>{const s=Pe();return e.jsx(k,{sx:{width:"100%"},children:e.jsxs(Ee,{children:[e.jsx(Oe,{expandIcon:e.jsx(A,{icon:"ooui:expand"}),"aria-controls":"panel1-content",id:"panel1-header",sx:{fontWeight:"bold"},children:"Neo Status"}),e.jsx(Ye,{children:e.jsx(be,{children:e.jsx(_e,{component:Ce,children:e.jsxs(Be,{size:s.dense?"small":"medium",children:[e.jsx(Re,{children:e.jsxs(j,{children:[e.jsx(d,{children:"Status"}),e.jsx(d,{align:"left",children:"Neo Status"}),e.jsx(d,{align:"center"})]})}),e.jsxs(Ge,{children:[e.jsxs(j,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Working"}),e.jsx(d,{children:"Active, Application Submitted, Appointment Set, Fresh (within 30 days), Pending, Underwriting Ready"})]}),e.jsxs(j,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Approved"}),e.jsx(d,{children:"Dead, Sold, Sold - Outside Finan, Sold & Verified (if sold date or DMS Id not there)"})]}),e.jsxs(j,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Ignored"}),e.jsx(d,{children:"Duplicate-Ignore"})]}),e.jsxs(j,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Sold"}),e.jsx(d,{children:"Sold, Sold - Outside Finan, Sold & Verified (Sold Date and DMS Id should be there)"})]}),e.jsxs(j,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Rejected"}),e.jsx(d,{children:"Rejected, Fresh (Older than 30 days)"})]}),e.jsxs(j,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Other"}),e.jsx(d,{children:"Application Ready, Approved - Not Sold, Assign Salesperson, Charged Off, Conditional Approval, Incomplete, Low Balance, Review"})]})]})]})})})})]})})},ze=({openFile:u,loading:s,handleClose:c,totalCount:i,tableDataExcel:p})=>{const r=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx($,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Z,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(z,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(J,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(q,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(K,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(U,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Q,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(X,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(L,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],M=()=>{const a=r.map(C=>C.headerName),n=p.map(C=>r.map(D=>C[D.field])),y=[a,...n],w=g.aoa_to_sheet(y),N=g.book_new();g.book_append_sheet(N,w,"Sheet1"),ee(N,"Monthly-report.xlsx"),V("Download successful."),c(!1)};return e.jsx(e.Fragment,{children:e.jsxs(De,{fullWidth:!0,open:u,onClose:c,PaperProps:{sx:{maxWidth:"100%",maxHeight:800}},children:[e.jsx(He,{children:e.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(F,{variant:"h6",children:"Preview"}),e.jsxs(k,{sx:{display:"flex",gap:2},children:[e.jsx(P,{variant:"contained",color:"primary",onClick:M,startIcon:e.jsx(A,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(je,{variant:"solid",sx:{fontWeight:"900"},onClick:c,children:e.jsx(A,{icon:"eva:close-outline"})})]})]})}),e.jsx(ae,{children:e.jsx(le,{rowCount:i,rows:p,columns:r,loading:s,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(v,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(F,{variant:"body2",sx:{pr:2},children:["1–0 of ",i]})})]})})},Je=({loading:u,totalCount:s,tableDataStatuswise:c,seriesLabel:i,handleRefreshPage:p})=>{const r=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx($,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Z,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(z,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(J,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(q,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(K,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(U,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Q,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(X,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(L,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],M=()=>{let a="";i!=null&&i.seriesName?a=`${i.seriesName}-${i.searchStartDate}-TO-${i.searchEndDate}.xlsx`:a=`All Data - ${i==null?void 0:i.searchStartDate}-TO-${i==null?void 0:i.searchEndDate}.xlsx`;const n=r.map(D=>D.headerName),y=c.map(D=>r.map(T=>D[T.field])),w=[n,...y],N=g.aoa_to_sheet(w),C=g.book_new();g.book_append_sheet(C,N,"Sheet1"),ee(C,a),V("Download successful."),handleClose(!1)};return e.jsx(e.Fragment,{children:e.jsxs(te,{children:[e.jsx(ae,{sx:{maxWidth:"100%",height:500},children:e.jsx(le,{rowCount:s,rows:c,columns:r,loading:u,paginationMode:"server",pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0,slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(Ve,{children:[e.jsxs(F,{variant:"h6",children:[i!=null&&i.seriesName?i==null?void 0:i.seriesName:"All Data"," : ",i==null?void 0:i.searchStartDate," To ",i==null?void 0:i.searchEndDate,"   "]}),e.jsxs(v,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(P,{variant:"contained",color:"primary",onClick:M,startIcon:e.jsx(A,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(P,{variant:"outlined",startIcon:e.jsx(A,{icon:"material-symbols:refresh"}),onClick:p,children:"Refresh"}),e.jsx($e,{})]})]})}),noRowsOverlay:()=>e.jsx(R,{title:"No Data"}),noResultsOverlay:()=>e.jsx(R,{title:"No results found"})}})}),e.jsx(v,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(F,{variant:"body2",sx:{pr:2},children:["1–0 of ",s]})})]})})},qe={search:"",startDate:Te(),endDate:new Date},Ke=()=>{const u=Ne();Se();const[s,c]=o.useState(!0),[i,p]=o.useState(!1),[r,M]=o.useState(qe),a=Ae(r.startDate,r.endDate),[n,y]=o.useState([]),[w,N]=o.useState([]),[C,D]=o.useState(Array),[T,re]=o.useState(!1),[ne,Qe]=o.useState([]),[E,se]=o.useState(0),[de,O]=o.useState();o.useEffect(()=>{s&&(oe(),_())},[s]);const oe=async()=>{var h;const l={searchStartDate:W(r.startDate),searchEndDate:W(r.endDate),search:r.search},{result:t,isLoading:m}=await Fe(l),f=((h=t==null?void 0:t.neoAppDataStatusWiseSummary)==null?void 0:h.map((x,b)=>({...x,id:b})))||[];D(t==null?void 0:t.neoAppDataSummaryPercents),y(f),c(m)},Y=async l=>{const{result:t,isLoading:m}=await Ie(l),f=(t==null?void 0:t.map((h,x)=>({...h,id:x})))||[];se(f==null?void 0:f.length),N(f),p(m)},me=o.useCallback((l,t)=>{M(m=>({...m,[l]:t})),c(!0)},[]),fe={labels:n==null?void 0:n.map(l=>[l.monthYear,`Total : ${l.totalApplications}`]),colors:[u.palette.primary.main,u.palette.error.main,u.palette.warning.main,u.palette.text.disabled],series:[{type:"Month",data:[{name:"Working Applications",data:n==null?void 0:n.map(l=>l.workingApplications)},{name:"Approved Applications",data:n.map(l=>l.approvedApplications)},{name:"Ignored Application",data:n.map(l=>l.ignoredApplications)},{name:"Rejected Application",data:n.map(l=>l.rejectedApplications)},{name:"Sold Application",data:n.map(l=>l.soldApplications)},{name:"Other Applications",data:n.map(l=>l.otherApplications)}],options:{}}]},ue=()=>{re(!open)},ce=(l,t)=>{l=l+1,t=+("20"+t);const m=r.startDate.getFullYear(),f=r.startDate.getMonth()+1,h=r.endDate.getFullYear(),x=r.endDate.getMonth()+1;console.log("1  start ---> ",{startYear:m,startMonth:f}),console.log("2 end ---> ",{endYear:h,endMonth:x}),console.log("3 end ---> ",{month:l,year:t});let b="",S="";return l===f&&t===m&&l===x&&t===h?(b=r.startDate,S=r.endDate):l===f&&t===m?(b=r.startDate,S=new Date(t,l,0)):l===x&&t===h?(b=new Date(t,l-1,1),S=r.endDate):(b=new Date(t,l-1,1),S=new Date(t,l,0)),{startDate:b,endDate:S}},he=async l=>{p(!0);const{label:t,seriesName:m}=l,f=t?t==null?void 0:t.split(" ")[0]:null,h=t?t==null?void 0:t.split(" ")[1]:null,x=m?m.split(" ")[0]:null;if(f){const b=h?parseInt(h,10):new Date().getFullYear(),B={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[f],{startDate:pe,endDate:xe}=ce(B,b);if(B!==void 0){const G={searchStartDate:W(pe),searchEndDate:W(xe),status:x,seriesName:m,search:""};O(G),await Y(G)}else console.log("Invalid month label")}},_=async()=>{const l={searchStartDate:W(r.startDate),searchEndDate:W(r.endDate),status:"",search:""};O(l),p(!0),await Y(l)};return e.jsx(e.Fragment,{children:s?e.jsx(We,{}):e.jsxs(ge,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(we,{heading:"Monthly Status Wise Summary",links:[{name:"Dashboard",href:Me.dashboard.root},{name:"Monthly Status Wise Summary"}],sx:{mb:{xs:3,md:3}}}),e.jsx(ie,{filters:r,dateError:a,onFilters:me}),n.length>0?e.jsx(ve,{title:"",chart:fe,handleChartClick:he}):e.jsx(R,{title:"No Data"}),e.jsx(te,{sx:{mb:3,marginTop:"30px"},children:e.jsx(Ze,{neoAppDataSummaryPercents:C})}),e.jsx(Je,{loading:i,handleRefreshPage:_,totalCount:E,seriesLabel:de,tableDataStatuswise:w}),T&&e.jsx(ze,{loading:i,openFile:T,handleClose:ue,totalCount:E,tableDataExcel:ne})]})})},Ue=Ke;function Ha(){return e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsx("title",{children:"Neo Verify | Monthly Status Wise Summary"})}),e.jsx(Ue,{})]})}export{Ha as default};
