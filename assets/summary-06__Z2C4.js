import{k,r as m,j as e,S as I,i as M,t as xe,K as be,W as Ce,T as w,q as _,f as A,d as je,e as H,e9 as Ne,l as We,d_ as Se,m as De,p as ye,H as Me}from"./index-kRLXSnYb.js";import{C as ge}from"./custom-breadcrumbs-HGFbEE0z.js";import{i as we}from"./format-time-fjZ5sEqX.js";import{b as Ae,f as D}from"./Common-G1wYpQPx.js";import{F as Te}from"./file-data-activity-pF-v7fqH.js";import{b as ve,G as ke,N as Ie}from"./neoVerify-oQ2HMuhO.js";import{D as O}from"./DatePicker-l7Cz83l9.js";import{f as Fe}from"./TextField-LgVzfg2l.js";import{E as Pe}from"./empty-content-QsTL2x8d.js";import{u as Re}from"./use-table-ks4uKpBn.js";import{f as Ee,a as S}from"./table-pagination-custom-PQ_zlYFY.js";import{T as Le,a as Oe,b as _e}from"./TableContainer-mvn7ptef.js";import{T as d}from"./TablePagination-KOYBt4OK.js";import{a as B,b as V,c as Y,d as G,e as Z,f as z,i as J,j as $,k as q,l as K}from"./report-table-row-JgqUlz5x.js";import{u as y,w as U}from"./xlsx-_hdJyjoG.js";import{D as Q}from"./DialogTitle-JPRL3x2S.js";import{D as X}from"./DialogContent-X0PYHqDf.js";import{D as ee}from"./DataGrid-yz0RLexc.js";import{C as ae}from"./Card-ksJn82IF.js";import{L as He}from"./LoadingButton-zc8TjIWX.js";import"./index-q81m-9gd.js";import"./format-number-Kck_p1h_.js";import"./use-chart-vEjI9oO5.js";import"./CardHeader-FOfyxlqi.js";import"./index-8PzNc7v7.js";import"./DialogActions-ZEpFCQ2N.js";import"./ListItem-mZ79RUB5.js";import"./Chip-kyyRbGwx.js";import"./Select-SiANy7Vl.js";import"./Checkbox-U5pzLUUV.js";import"./SwitchBase-7eIMwj3z.js";import"./FormControlLabel-UKLx0s_n.js";import"./Switch-0ypcjG03.js";import"./KeyboardArrowRight-qKAWApv2.js";import"./FirstPage-OposL62N.js";import"./Box-pmRaPgK4.js";import"./Stack-RgaqovSa.js";import"./dialogTitleClasses-YtvjPvm9.js";import"./Autocomplete-mTTV3k6o.js";import"./Close-K-QLqSZV.js";import"./ClickAwayListener-f8KxXSqF.js";import"./Skeleton-7PpzZpzo.js";import"./CircularProgress-vnFNSyZr.js";function le({filters:f,onFilters:n,dateError:u}){const o=m.useCallback(r=>{n("startDate",r)},[n]),p=m.useCallback(r=>{n("endDate",r)},[n]);return e.jsx(e.Fragment,{children:e.jsxs(I,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(O,{label:"Start date",value:f.startDate,onChange:o,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(O,{label:"End date",value:f.endDate,onChange:p,slotProps:{textField:{fullWidth:!0,error:u}},sx:{maxWidth:{md:200},[`& .${Fe.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}le.propTypes={dateError:k.bool,filters:k.object,onFilters:k.func};const Be=({neoAppDataSummaryPercents:f})=>{const n=Re();return e.jsx(M,{sx:{width:"100%"},children:e.jsx(xe,{children:e.jsx(Le,{component:be,children:e.jsxs(Oe,{size:n.dense?"small":"medium",children:[e.jsx(Ee,{children:e.jsxs(S,{children:[e.jsx(d,{children:"Status"}),e.jsx(d,{align:"left",children:"Neo Status"}),e.jsx(d,{align:"center"})]})}),e.jsxs(_e,{children:[e.jsxs(S,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Working"}),e.jsx(d,{children:"Active, Application Submitted, Appointment Set, Fresh (within 30 days), Pending, Underwriting Ready"})]}),e.jsxs(S,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Approved"}),e.jsx(d,{children:"Dead, Sold, Sold - Outside Finan, Sold & Verified (if sold date or DMS Id not there)"})]}),e.jsxs(S,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Ignored"}),e.jsx(d,{children:"Duplicate-Ignore"})]}),e.jsxs(S,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Sold"}),e.jsx(d,{children:"Sold, Sold - Outside Finan, Sold & Verified (Sold Date and DMS Id should be there)"})]}),e.jsxs(S,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Rejected"}),e.jsx(d,{children:"Rejected, Fresh (Older than 30 days)"})]}),e.jsxs(S,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Other"}),e.jsx(d,{children:"Application Ready, Approved - Not Sold, Assign Salesperson, Charged Off, Conditional Approval, Incomplete, Low Balance, Review"})]})]})]})})})})},Ve=({openFile:f,loading:n,handleClose:u,totalCount:o,tableDataExcel:p})=>{const r=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:l=>e.jsx(B,{params:l})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(V,{params:l})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(Y,{params:l})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(G,{params:l})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(Z,{params:l})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(z,{params:l})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(J,{params:l})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx($,{params:l})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(q,{params:l})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:l=>e.jsx(K,{params:l})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],a=()=>{const l=r.map(j=>j.headerName),s=p.map(j=>r.map(T=>j[T.field])),g=[l,...s],C=y.aoa_to_sheet(g),b=y.book_new();y.book_append_sheet(b,C,"Sheet1"),U(b,"Monthly-report.xlsx"),H("Download successful."),u(!1)};return e.jsx(e.Fragment,{children:e.jsxs(Ce,{fullWidth:!0,open:f,onClose:u,PaperProps:{sx:{maxWidth:"100%",maxHeight:800}},children:[e.jsx(Q,{children:e.jsxs(M,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(w,{variant:"h6",children:"Preview"}),e.jsxs(M,{sx:{display:"flex",gap:2},children:[e.jsx(_,{variant:"contained",color:"primary",onClick:a,startIcon:e.jsx(A,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(je,{variant:"solid",sx:{fontWeight:"900"},onClick:u,children:e.jsx(A,{icon:"eva:close-outline"})})]})]})}),e.jsx(X,{children:e.jsx(ee,{rowCount:o,rows:p,columns:r,loading:n,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(I,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(w,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",o]})})]})})},Ye=({loading:f,totalCount:n,tableDataStatuswise:u,seriesLabel:o})=>{const p=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(B,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(V,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Y,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(G,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Z,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(z,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(J,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx($,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(q,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(K,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],r=()=>{const a=p.map(b=>b.headerName),l=u.map(b=>p.map(j=>b[j.field])),s=[a,...l],g=y.aoa_to_sheet(s),C=y.book_new();y.book_append_sheet(C,g,"Sheet1"),U(C,"Monthly-report.xlsx"),H("Download successful."),handleClose(!1)};return e.jsx(e.Fragment,{children:e.jsxs(ae,{children:[e.jsx(Q,{children:e.jsxs(M,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(w,{variant:"h6",children:[o==null?void 0:o.seriesName," : ",o==null?void 0:o.label]}),e.jsx(M,{sx:{display:"flex",gap:2},children:e.jsx(_,{variant:"contained",color:"primary",onClick:r,startIcon:e.jsx(A,{icon:"eva:cloud-download-fill"}),children:"Download"})})]})}),e.jsx(X,{sx:{maxWidth:"100%",maxHeight:500},children:e.jsx(ee,{rowCount:n,rows:u,columns:p,loading:f,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(I,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(w,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",n]})})]})})},Ge={search:"",startDate:Ae(),endDate:new Date},Ze=()=>{const f=Ne();We();const[n,u]=m.useState(!0),[o,p]=m.useState(!1),[r,a]=m.useState(Ge),l=we(r.startDate,r.endDate),[s,g]=m.useState([]),[C,b]=m.useState([]),[j,T]=m.useState(Array),[F,P]=m.useState(!1),[te,ie]=m.useState([]),[R,E]=m.useState(0),[re,ne]=m.useState();m.useEffect(()=>{n&&se()},[n]);const se=async()=>{var c;const i={searchStartDate:D(r.startDate),searchEndDate:D(r.endDate),search:r.search},{result:t,isLoading:h}=await ve(i),x=((c=t==null?void 0:t.neoAppDataStatusWiseSummary)==null?void 0:c.map((N,W)=>({...N,id:W})))||[];T(t==null?void 0:t.neoAppDataSummaryPercents),g(x),u(h)},de=async i=>{const{result:t,isLoading:h}=await Ie(i),x=(t==null?void 0:t.map((c,N)=>({...c,id:N})))||[];E(x==null?void 0:x.length),b(x),u(h)},oe=m.useCallback((i,t)=>{a(h=>({...h,[i]:t})),u(!0)},[]),me={labels:s==null?void 0:s.map(i=>[i.monthYear,`Total : ${i.totalApplications}`]),colors:[f.palette.primary.main,f.palette.error.main,f.palette.warning.main,f.palette.text.disabled],series:[{type:"Month",data:[{name:"Working Applications",data:s==null?void 0:s.map(i=>i.workingApplications)},{name:"Approved Applications",data:s.map(i=>i.approvedApplications)},{name:"Ignored Application",data:s.map(i=>i.ignoredApplications)},{name:"Rejected Application",data:s.map(i=>i.rejectedApplications)},{name:"Sold Application",data:s.map(i=>i.soldApplications)},{name:"Other Applications",data:s.map(i=>i.otherApplications)}],options:{}}]},fe=()=>{P(!open)},ue=async i=>{try{p(!0);const t={searchStartDate:D(r.startDate),searchEndDate:D(r.endDate),search:r.search},{result:h,isLoading:x}=await ke(t),c=(h==null?void 0:h.map((N,W)=>({...N,id:W})))||[];P(!0),b(),E(c==null?void 0:c.length),ie(c),p(x)}catch(t){console.error(t)}},he=async i=>{const{label:t,seriesName:h}=i;ne(i);const x=t?t==null?void 0:t.split(" ")[0]:null,c=t?t==null?void 0:t.split(" ")[1]:null,N=h?h.split(" ")[0]:null;if(x){const W=c?parseInt(c,10):new Date().getFullYear();console.log("getLabel","20"+W);const v={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[x];if(v!==void 0){const ce=new Date("20"+W,v,1),pe=new Date("20"+W,v+1,0),L={searchStartDate:D(ce),searchEndDate:D(pe),status:N,search:""};await de(L),console.log("handleChartClick",L)}else console.log("Invalid month label")}};return e.jsx(e.Fragment,{children:n?e.jsx(Se,{}):e.jsxs(De,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(ge,{heading:"Monthly Status Wise Summary",links:[{name:"Dashboard",href:ye.dashboard.root},{name:"Monthly Status Wise Summary"}],action:e.jsx(M,{display:"flex",gap:2,children:e.jsx(He,{variant:"contained",startIcon:e.jsx(A,{icon:"solar:export-bold"}),onClick:ue,loading:o,children:"Export"})}),sx:{mb:{xs:3,md:3}}}),e.jsx(le,{filters:r,dateError:l,onFilters:oe}),s.length>0?e.jsx(Te,{title:"",chart:me,handleChartClick:he}):e.jsx(Pe,{title:"No Data"}),e.jsx(ae,{sx:{mb:3,marginTop:"30px"},children:e.jsx(Be,{neoAppDataSummaryPercents:j})}),C&&C.length>0&&e.jsx(Ye,{loading:n,totalCount:R,seriesLabel:re,tableDataStatuswise:C}),F&&e.jsx(Ve,{loading:o,openFile:F,handleClose:fe,totalCount:R,tableDataExcel:te})]})})},ze=Ze;function Oa(){return e.jsxs(e.Fragment,{children:[e.jsx(Me,{children:e.jsx("title",{children:"Neo Verify | Monthly Status Wise Summary"})}),e.jsx(ze,{})]})}export{Oa as default};
