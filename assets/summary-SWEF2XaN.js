import{k as I,r as o,j as e,S as w,i as F,t as pe,K as xe,W as be,T as A,q as P,f as T,d as Ce,e as V,e9 as je,l as Ne,d_ as De,m as Se,p as We,H as ye}from"./index-VrKf3MXp.js";import{C as Me}from"./custom-breadcrumbs-r35tiFD2.js";import{i as ge}from"./format-time-q9sVWsGT.js";import{b as we,f as j}from"./Common-UcI4IF-1.js";import{F as Ae}from"./file-data-activity-Rs0Zy6WD.js";import{b as Te,N as ve}from"./neoVerify-yRd8KQM_.js";import{D as G}from"./DatePicker-zSaASXMb.js";import{f as ke}from"./TextField-M7ya3cUr.js";import{E as R}from"./empty-content-HYTs7pGt.js";import{u as Ie}from"./use-table-fQ6rVYZD.js";import{f as Fe,a as C}from"./table-pagination-custom-H-yBa7iU.js";import{T as Pe,a as Re,b as Ee}from"./TableContainer-jsgpl8-F.js";import{T as d}from"./TablePagination-zOLwidd4.js";import{a as Y,b as Z,c as z,d as L,e as J,f as $,i as q,j as K,k as U,l as Q}from"./report-table-row-ADympcd_.js";import{u as N,w as X}from"./xlsx-_hdJyjoG.js";import{D as Oe}from"./DialogTitle-azQfKkeq.js";import{D as ee}from"./DialogContent-7q7CKxZt.js";import{D as ae}from"./DataGrid-gEApS9-1.js";import{C as le}from"./Card-7F37HUwY.js";import{G as _e,a as He}from"./GridToolbarColumnsButton-hb6akDGO.js";import"./index-q81m-9gd.js";import"./format-number-p_s9Ejs-.js";import"./use-chart-NPH6FJu4.js";import"./CardHeader-9eXpTTDa.js";import"./index-9zWF8XKr.js";import"./DialogActions-0TfB1fYs.js";import"./ListItem-BDK5VqgW.js";import"./Chip-AL6A0Qza.js";import"./Select-k0F3GZUn.js";import"./Checkbox-sATYeu_2.js";import"./SwitchBase-gjAkslHG.js";import"./FormControlLabel-SSbvDclG.js";import"./Switch-LShhegwA.js";import"./KeyboardArrowRight-17E6xXBl.js";import"./FirstPage-l3wWLLM5.js";import"./Box-56VEDvEQ.js";import"./Stack-8Jtz0QYl.js";import"./dialogTitleClasses-iB2CsVlE.js";import"./Autocomplete-ZJ8WBWjP.js";import"./Close-rEFf0etn.js";import"./ClickAwayListener-gQOC_HIJ.js";import"./Skeleton-MEnLOIvT.js";import"./CircularProgress-hc7Idncv.js";function te({filters:m,onFilters:n,dateError:f}){const r=o.useCallback(i=>{n("startDate",i)},[n]),p=o.useCallback(i=>{n("endDate",i)},[n]);return e.jsx(e.Fragment,{children:e.jsxs(w,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(G,{label:"Start date",value:m.startDate,onChange:r,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(G,{label:"End date",value:m.endDate,onChange:p,slotProps:{textField:{fullWidth:!0,error:f}},sx:{maxWidth:{md:200},[`& .${ke.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}te.propTypes={dateError:I.bool,filters:I.object,onFilters:I.func};const Be=({neoAppDataSummaryPercents:m})=>{const n=Ie();return e.jsx(F,{sx:{width:"100%"},children:e.jsx(pe,{children:e.jsx(Pe,{component:xe,children:e.jsxs(Re,{size:n.dense?"small":"medium",children:[e.jsx(Fe,{children:e.jsxs(C,{children:[e.jsx(d,{children:"Status"}),e.jsx(d,{align:"left",children:"Neo Status"}),e.jsx(d,{align:"center"})]})}),e.jsxs(Ee,{children:[e.jsxs(C,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Working"}),e.jsx(d,{children:"Active, Application Submitted, Appointment Set, Fresh (within 30 days), Pending, Underwriting Ready"})]}),e.jsxs(C,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Approved"}),e.jsx(d,{children:"Dead, Sold, Sold - Outside Finan, Sold & Verified (if sold date or DMS Id not there)"})]}),e.jsxs(C,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Ignored"}),e.jsx(d,{children:"Duplicate-Ignore"})]}),e.jsxs(C,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Sold"}),e.jsx(d,{children:"Sold, Sold - Outside Finan, Sold & Verified (Sold Date and DMS Id should be there)"})]}),e.jsxs(C,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Rejected"}),e.jsx(d,{children:"Rejected, Fresh (Older than 30 days)"})]}),e.jsxs(C,{children:[e.jsx(d,{sx:{fontWeight:"bold"},children:"Other"}),e.jsx(d,{children:"Application Ready, Approved - Not Sold, Assign Salesperson, Charged Off, Conditional Approval, Incomplete, Low Balance, Review"})]})]})]})})})})},Ge=({openFile:m,loading:n,handleClose:f,totalCount:r,tableDataExcel:p})=>{const i=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(Y,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Z,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(z,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(L,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(J,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx($,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(q,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(K,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(U,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Q,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],D=()=>{const a=i.map(u=>u.headerName),s=p.map(u=>i.map(y=>u[y.field])),S=[a,...s],W=N.aoa_to_sheet(S),x=N.book_new();N.book_append_sheet(x,W,"Sheet1"),X(x,"Monthly-report.xlsx"),V("Download successful."),f(!1)};return e.jsx(e.Fragment,{children:e.jsxs(be,{fullWidth:!0,open:m,onClose:f,PaperProps:{sx:{maxWidth:"100%",maxHeight:800}},children:[e.jsx(Oe,{children:e.jsxs(F,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(A,{variant:"h6",children:"Preview"}),e.jsxs(F,{sx:{display:"flex",gap:2},children:[e.jsx(P,{variant:"contained",color:"primary",onClick:D,startIcon:e.jsx(T,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(Ce,{variant:"solid",sx:{fontWeight:"900"},onClick:f,children:e.jsx(T,{icon:"eva:close-outline"})})]})]})}),e.jsx(ee,{children:e.jsx(ae,{rowCount:r,rows:p,columns:i,loading:n,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(w,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(A,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",r]})})]})})},Ve=({loading:m,totalCount:n,tableDataStatuswise:f,seriesLabel:r,handleRefreshPage:p})=>{const i=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(Y,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Z,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(z,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(L,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(J,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx($,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(q,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(K,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(U,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Q,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],D=()=>{const a=i.map(u=>u.headerName),s=f.map(u=>i.map(y=>u[y.field])),S=[a,...s],W=N.aoa_to_sheet(S),x=N.book_new();N.book_append_sheet(x,W,"Sheet1"),X(x,"Monthly-report.xlsx"),V("Download successful."),handleClose(!1)};return e.jsx(e.Fragment,{children:e.jsxs(le,{children:[e.jsx(ee,{sx:{maxWidth:"100%",maxHeight:500},children:e.jsx(ae,{rowCount:n,rows:f,columns:i,loading:m,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0,slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(_e,{children:[e.jsxs(A,{variant:"h6",children:[r!=null&&r.seriesName?r==null?void 0:r.seriesName:"All Data"," : ",r==null?void 0:r.searchStartDate," To ",r==null?void 0:r.searchEndDate,"   "]}),e.jsxs(w,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(P,{variant:"contained",color:"primary",onClick:D,startIcon:e.jsx(T,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(P,{variant:"outlined",startIcon:e.jsx(T,{icon:"material-symbols:refresh"}),onClick:p,children:"Refresh"}),e.jsx(He,{})]})]})}),noRowsOverlay:()=>e.jsx(R,{title:"No Data"}),noResultsOverlay:()=>e.jsx(R,{title:"No results found"})}})}),e.jsx(w,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(A,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",n]})})]})})},Ye={search:"",startDate:we(),endDate:new Date},Ze=()=>{const m=je();Ne();const[n,f]=o.useState(!0),[r,p]=o.useState(!1),[i,D]=o.useState(Ye),a=ge(i.startDate,i.endDate),[s,S]=o.useState([]),[W,x]=o.useState([]),[u,y]=o.useState(Array),[E,ie]=o.useState(!1),[re,Le]=o.useState([]),[O,ne]=o.useState(0),[se,_]=o.useState();o.useEffect(()=>{n&&(de(),B())},[n]);const de=async()=>{var b;const l={searchStartDate:j(i.startDate),searchEndDate:j(i.endDate),search:i.search},{result:t,isLoading:h}=await Te(l),c=((b=t==null?void 0:t.neoAppDataStatusWiseSummary)==null?void 0:b.map((M,g)=>({...M,id:g})))||[];y(t==null?void 0:t.neoAppDataSummaryPercents),S(c),f(h)},H=async l=>{const{result:t,isLoading:h}=await ve(l),c=(t==null?void 0:t.map((b,M)=>({...b,id:M})))||[];ne(c==null?void 0:c.length),x(c),f(h)},oe=o.useCallback((l,t)=>{D(h=>({...h,[l]:t})),f(!0)},[]),me={labels:s==null?void 0:s.map(l=>[l.monthYear,`Total : ${l.totalApplications}`]),colors:[m.palette.primary.main,m.palette.error.main,m.palette.warning.main,m.palette.text.disabled],series:[{type:"Month",data:[{name:"Working Applications",data:s==null?void 0:s.map(l=>l.workingApplications)},{name:"Approved Applications",data:s.map(l=>l.approvedApplications)},{name:"Ignored Application",data:s.map(l=>l.ignoredApplications)},{name:"Rejected Application",data:s.map(l=>l.rejectedApplications)},{name:"Sold Application",data:s.map(l=>l.soldApplications)},{name:"Other Applications",data:s.map(l=>l.otherApplications)}],options:{}}]},fe=()=>{ie(!open)},ue=async l=>{const{label:t,seriesName:h}=l,c=t?t==null?void 0:t.split(" ")[0]:null,b=t?t==null?void 0:t.split(" ")[1]:null,M=h?h.split(" ")[0]:null;if(c){const g=b?parseInt(b,10):new Date().getFullYear(),v={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[c];if(v!==void 0){const he=new Date("20"+g,v,1),ce=new Date("20"+g,v+1,0),k={searchStartDate:j(he),searchEndDate:j(ce),status:M,seriesName:h,search:""};_(k),await H(k),console.log("handleChartClick",k)}else console.log("Invalid month label")}},B=async()=>{const l={searchStartDate:j(i.startDate),searchEndDate:j(i.endDate),status:"",search:""};_(l),await H(l)};return e.jsx(e.Fragment,{children:n?e.jsx(De,{}):e.jsxs(Se,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(Me,{heading:"Monthly Status Wise Summary",links:[{name:"Dashboard",href:We.dashboard.root},{name:"Monthly Status Wise Summary"}],sx:{mb:{xs:3,md:3}}}),e.jsx(te,{filters:i,dateError:a,onFilters:oe}),s.length>0?e.jsx(Ae,{title:"",chart:me,handleChartClick:ue}):e.jsx(R,{title:"No Data"}),e.jsx(le,{sx:{mb:3,marginTop:"30px"},children:e.jsx(Be,{neoAppDataSummaryPercents:u})}),e.jsx(Ve,{loading:n,handleRefreshPage:B,totalCount:O,seriesLabel:se,tableDataStatuswise:W}),E&&e.jsx(Ge,{loading:r,openFile:E,handleClose:fe,totalCount:O,tableDataExcel:re})]})})},ze=Ze;function _a(){return e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsx("title",{children:"Neo Verify | Monthly Status Wise Summary"})}),e.jsx(ze,{})]})}export{_a as default};
