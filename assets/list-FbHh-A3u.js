import{r as d,j as e,M as q,k as n,dU as W,cU as R,l as z,m as V,p as J,i as K,q as y,f as D,S as g,T as Q,H as X}from"./index-d_hKz2zC.js";import{C as Z}from"./custom-breadcrumbs-m3uTbUbB.js";import{D as v}from"./DatePicker-1o6ZobtL.js";import{f as _,F as ee,I as te}from"./TextField-e_4V3qEH.js";import{S as re}from"./Select-2T8XbQkD.js";import{i as ae}from"./format-time-z29mBrbB.js";import{f as j,a as se}from"./Common-Lq1jqW5E.js";import{B as c}from"./Box-YEoiatRk.js";import{E as T}from"./empty-content-rjL4BROV.js";import{u as oe}from"./index-UCMIsoTk.js";import{C as ne}from"./Card-L-UFOQRR.js";import{D as le}from"./DataGrid-_SaDrd4X.js";import{G as ie,a as de}from"./GridToolbarColumnsButton-3Qx5kILf.js";import"./index-q81m-9gd.js";import"./DialogActions-61XMFn37.js";import"./ListItem-GcHU8I0M.js";import"./Chip-zv-zFcnm.js";import"./DialogContent-djGsL5zT.js";import"./dialogTitleClasses-eDgHBsb0.js";import"./Autocomplete-kTg74uCO.js";import"./Close-xsTIKsBy.js";import"./ClickAwayListener-k95km_zw.js";import"./Checkbox-18nfoWP1.js";import"./SwitchBase-dTKHZsQn.js";import"./Switch-JVioLfQ0.js";import"./Skeleton-UmRw-0hV.js";import"./CircularProgress-HMYL4JU-.js";import"./TablePagination-D8rHsU24.js";import"./KeyboardArrowRight-UESfApTO.js";import"./FirstPage-ebjW-duc.js";import"./FormControlLabel-D_dWO09R.js";function E({filters:t,onFilters:o,dateError:s,GetAllCompanyData:r,selectCompany:i,setSelectCompany:f}){const x=d.useCallback(l=>{f(l.target.value),o("companyId",l.target.value)},[o]),w=d.useCallback(l=>{o("startDate",l)},[o]),p=d.useCallback(l=>{o("endDate",l)},[o]);return e.jsxs(e.Fragment,{children:[e.jsx(v,{label:"Start date",value:t.startDate,onChange:w,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:300}}}),e.jsx(v,{label:"End date",value:t.endDate,onChange:p,slotProps:{textField:{fullWidth:!0,error:s}},sx:{maxWidth:{md:300},[`& .${_.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}}),e.jsxs(ee,{sx:{maxWidth:{md:240},width:"100%"},children:[e.jsx(te,{id:"demo-simple-select-helper-label",shrink:!!i,children:"Company Name"}),e.jsx(re,{labelId:"demo-simple-select-helper-label",id:"demo-simple-select-helper",value:i,label:"Company Name",onChange:x,children:r==null?void 0:r.map(l=>e.jsx(q,{value:l.companyId,children:l.companyName},l.companyId))})]})]})}E.propTypes={dateError:n.bool,filters:n.object,onFilters:n.func};const ce=async t=>{const o=R.reports.transactionDetailReport,{data:s,error:r}=await W.post(o,t),i=s!=null&&s.data?s==null?void 0:s.data:null;return{result:i||[],isLoading:!r&&!i,isError:r,status:s==null?void 0:s.status,message:s==null?void 0:s.message,vendorsEmpty:!(i!=null&&i.length)}};function N({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:t.row.docNumber})}N.propTypes={params:n.shape({row:n.object})};function I({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:t.row.name})}I.propTypes={params:n.shape({row:n.object})};function M({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:j(t.row.date)})}M.propTypes={params:n.shape({row:n.object})};function F({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:t.row.class})}F.propTypes={params:n.shape({row:n.object})};function O({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:t.row.account})}O.propTypes={params:n.shape({row:n.object})};function k({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:t.row.type})}k.propTypes={params:n.shape({row:n.object})};function L({params:t}){return e.jsx(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:`${se(t.row.amount)}`})}L.propTypes={params:n.shape({row:n.object})};function A({params:t}){return e.jsx(c,{sx:{whiteSpace:"wrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:t.row.description})}A.propTypes={params:n.shape({row:n.object})};n.shape({row:n.object});const me=async t=>{try{const[o,s]=Array.isArray(t)?t:[t],r=await W.post(o);if(!r.data||!r.data.data)throw new Error("Unexpected response structure");return r.data.data}catch(o){throw console.error("Error in fetcher:",o),o}};function pe(){const t=R.common.companyList,{data:o,error:s}=oe(t,me,{revalidateOnFocus:!1}),r=o||null;return{GetAllCompanyData:r||[],isLoading:!s&&!r,isError:s,EmployeeEmpty:!(r!=null&&r.length)}}function G(){const t=new Date;return new Date(t.setDate(t.getDate()-7))}const S={search:"",startDate:G(),endDate:new Date,companyId:""};function ue(){z();const{GetAllCompanyData:t}=pe(),[o,s]=d.useState(!0),[r,i]=d.useState(S),f=ae(r.startDate,r.endDate),[x,w]=d.useState([]),[p,l]=d.useState(0),[u,C]=d.useState(null);d.useEffect(()=>{o&&P()},[o,u]),d.useEffect(()=>{var a;t.length>0&&u===null&&C((a=t[0])==null?void 0:a.companyId)},[t]);const P=async()=>{const a={searchStartDate:j(r.startDate),searchEndDate:j(r.endDate),search:r.search,companyId:u||r.companyId},{result:m,isLoading:b}=await ce(a),h=(m==null?void 0:m.map((H,$)=>({...H,id:$})))||[];l(h==null?void 0:h.length),w(h),s(b)},B=d.useCallback((a,m)=>{i(b=>({...b,[a]:m})),s(!0)},[]),U=()=>{const a={...S,startDate:G(),endDate:new Date};i(a),s(!0)},Y=[{field:"type",headerName:"Transaction Type",minWidth:150,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(k,{params:a})},{field:"date",headerName:"Date",minWidth:120,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(M,{params:a})},{field:"docNumber",headerName:"Num",flex:1,minWidth:250,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(N,{params:a})},{field:"name",headerName:"Name",editable:!1,flex:1,minWidth:250,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(I,{params:a})},{field:"description",headerName:"Memo/Description",editable:!1,minWidth:600,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(A,{params:a})},{field:"account",headerName:"Account",editable:!1,minWidth:250,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(O,{params:a})},{field:"class",headerName:"Class",editable:!1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(F,{params:a})},{field:"amount",headerName:"Amount",editable:!1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(L,{params:a})}];return e.jsx(e.Fragment,{children:e.jsxs(V,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(Z,{heading:"Transaction Details by Account",links:[{name:"Dashboard",href:J.dashboard.root},{name:"Transaction Detail Report"}],action:e.jsxs(K,{display:"flex",gap:2,children:[e.jsx(y,{variant:"outlined",startIcon:e.jsx(D,{icon:"material-symbols:refresh"}),onClick:U,children:"Refresh"}),e.jsx(y,{variant:"contained",startIcon:e.jsx(D,{icon:"solar:export-bold"}),children:"Export"})]}),sx:{mb:{xs:3,md:5}}}),e.jsxs(ne,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:[e.jsx(le,{rowCount:p,rows:x,columns:Y,loading:o,pageSizeOptions:[],hideFooterPagination:!0,disableColumnMenu:!0,slots:{toolbar:()=>e.jsx(e.Fragment,{children:e.jsxs(ie,{children:[e.jsx(E,{filters:r,dateError:f,onFilters:B,setSelectCompany:C,selectCompany:u,GetAllCompanyData:t}),e.jsx(g,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:e.jsx(de,{})})]})}),noRowsOverlay:()=>e.jsx(T,{title:"No Data"}),noResultsOverlay:()=>e.jsx(T,{title:"No results found"})}}),e.jsx(g,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(Q,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",p]})})]})]})})}function qe(){return e.jsxs(e.Fragment,{children:[e.jsx(X,{children:e.jsx("title",{children:"  Transaction Details Report "})}),e.jsx(ue,{})]})}export{qe as default};
