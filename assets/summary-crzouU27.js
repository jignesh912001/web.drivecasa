import{k as M,r as d,j as e,S as F,i as D,t as _,K as O,W as z,T as k,q as Z,f as A,d as $,e as q,e9 as K,l as J,d_ as Q,m as U,p as X,H as ee}from"./index-SRBoHPGP.js";import{C as ae}from"./custom-breadcrumbs-2Vt61DQy.js";import{i as le}from"./format-time-Dhw0Bl7u.js";import{b as te,f as j}from"./Common-TtK5h9Zk.js";import{F as re}from"./file-data-activity-9sXAviKX.js";import{a as ie,G as se}from"./neoVerify-0DyrRFUn.js";import{D as v}from"./DatePicker-QnAwmS6v.js";import{f as oe}from"./TextField-ZdzIPEIw.js";import{E as ne}from"./empty-content-pQ9Ptn5I.js";import{u as de}from"./use-table-I3wrv5Sv.js";import{f as me,a as fe}from"./table-pagination-custom-KQjIE8JI.js";import{T as pe,a as ce,b as T}from"./TableContainer-JFRVcjgG.js";import{T as f}from"./TablePagination-xdeqv1In.js";import{a as ue,b as he,c as xe,d as be,e as Ce,f as je,i as De,j as Ne,k as ye,l as ge}from"./report-table-row-5Yo0-Xun.js";import{u as w,w as Se}from"./xlsx-_hdJyjoG.js";import{D as We}from"./DialogTitle-wDqayfkq.js";import{D as Me}from"./DialogContent--hYL-nvd.js";import{D as Te}from"./DataGrid-YzLanx__.js";import{L as we}from"./LoadingButton-u5k4bW_n.js";import{C as Ae}from"./Card-rfFRnjEZ.js";import"./index-q81m-9gd.js";import"./format-number-Shtyhez5.js";import"./use-chart-xPlwTHId.js";import"./CardHeader-7To0ZcbF.js";import"./index-daZlzyRR.js";import"./DialogActions-a6xymSGg.js";import"./ListItem-8jG3SovY.js";import"./Chip-1zqzKdIi.js";import"./Select-1AyAhxkn.js";import"./Checkbox-PTTPhCTK.js";import"./SwitchBase-ELVdoIZI.js";import"./FormControlLabel-B9iY2wab.js";import"./Switch-QTFGUNLA.js";import"./KeyboardArrowRight-odMl_Tik.js";import"./FirstPage-mpplmv8r.js";import"./Box-V6e44kbg.js";import"./Stack-KbtAr8eq.js";import"./dialogTitleClasses-E3YOcI6U.js";import"./Autocomplete-uiGe8Sdd.js";import"./Close-nuwh-Gc5.js";import"./ClickAwayListener-tgiWrSVt.js";import"./Skeleton-ihFS-rOi.js";import"./CircularProgress-vqzjPLr6.js";function P({filters:s,onFilters:o,dateError:t}){const r=d.useCallback(l=>{o("startDate",l)},[o]),p=d.useCallback(l=>{o("endDate",l)},[o]);return e.jsx(e.Fragment,{children:e.jsxs(F,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(v,{label:"Start date",value:s.startDate,onChange:r,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(v,{label:"End date",value:s.endDate,onChange:p,slotProps:{textField:{fullWidth:!0,error:t}},sx:{maxWidth:{md:200},[`& .${oe.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}P.propTypes={dateError:M.bool,filters:M.object,onFilters:M.func};const ke=({neoAppDataSummaryPercents:s})=>{const o=de();return e.jsx(D,{sx:{width:"100%"},children:e.jsx(_,{children:e.jsx(pe,{component:O,children:e.jsxs(ce,{size:(o.dense,"small"),children:[e.jsx(me,{children:e.jsxs(fe,{children:[e.jsx(f,{}),s.map((t,r)=>e.jsx(f,{children:t.monthName},r))]})}),e.jsxs(T,{children:[e.jsx(f,{sx:{fontWeight:"bold"},children:"Book To Look"}),s.map((t,r)=>e.jsxs(f,{children:[t.bookToLookPercentage," %"]},r))]}),e.jsxs(T,{children:[e.jsx(f,{sx:{fontWeight:"bold"},children:"Book To Approved"}),s.map((t,r)=>e.jsxs(f,{children:[t.bookToApprovedPercentage," %"]},r))]}),e.jsxs(T,{children:[e.jsx(f,{sx:{fontWeight:"bold"},children:"Approved"}),s.map((t,r)=>e.jsxs(f,{children:[t.approvedPercentage," %"]},r))]})]})})})})},ve=({openFile:s,loading:o,handleClose:t,totalCount:r,tableDataExcel:p})=>{const l=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(ue,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(he,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(xe,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(be,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Ce,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(je,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(De,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Ne,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ye,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ge,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],N=()=>{const a=l.map(h=>h.headerName),m=p.map(h=>l.map(C=>h[C.field])),y=[a,...m],x=w.aoa_to_sheet(y),b=w.book_new();w.book_append_sheet(b,x,"Sheet1"),Se(b,"Monthly-report.xlsx"),q("Download successful."),t(!1)};return e.jsx(e.Fragment,{children:e.jsxs(z,{fullWidth:!0,open:s,onClose:t,PaperProps:{sx:{maxWidth:"100%",maxHeight:800}},children:[e.jsx(We,{children:e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(k,{variant:"h6",children:"Preview"}),e.jsxs(D,{sx:{display:"flex",gap:2},children:[e.jsx(Z,{variant:"contained",color:"primary",onClick:N,startIcon:e.jsx(A,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx($,{variant:"solid",sx:{fontWeight:"900"},onClick:t,children:e.jsx(A,{icon:"eva:close-outline"})})]})]})}),e.jsx(Me,{children:e.jsx(Te,{rowCount:r,rows:p,columns:l,loading:o,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(F,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(k,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",r]})})]})})},Fe={search:"",startDate:te(),endDate:new Date},Pe=()=>{const s=K();J();const[o,t]=d.useState(!0),[r,p]=d.useState(!1),[l,N]=d.useState(Fe),a=le(l.startDate,l.endDate),[m,y]=d.useState([]),[x,b]=d.useState(Array),[h,C]=d.useState(!1),[E,L]=d.useState([]),[R,I]=d.useState(0);d.useEffect(()=>{o&&B()},[o]);const B=async()=>{var u;const i={searchStartDate:j(l.startDate),searchEndDate:j(l.endDate),search:l.search},{result:n,isLoading:c}=await ie(i),g=((u=n==null?void 0:n.neoAppDataSummaries)==null?void 0:u.map((S,W)=>({...S,id:W})))||[];b(n==null?void 0:n.neoAppDataSummaryPercents),y(g),t(c)},H=d.useCallback((i,n)=>{N(c=>({...c,[i]:n})),t(!0)},[]),G={labels:m==null?void 0:m.map(i=>[i.monthYear,`Total : ${i.totalApplications}`]),colors:[s.palette.primary.main,s.palette.error.main,s.palette.warning.main,s.palette.text.disabled],series:[{type:"Month",data:[{name:"Funded Sold",data:m.map(i=>i.appsFundedSold)},{name:"Incomplete Applications",data:m.map(i=>i.incompleteApplications)},{name:"Approved Not Sold",data:m.map(i=>i.appsApprovedNotSold)},{name:"Declined",data:m.map(i=>i.appsDeclined)}],options:{}}]},V=()=>{C(!open)},Y=async i=>{try{p(!0);const n={searchStartDate:j(l.startDate),searchEndDate:j(l.endDate),search:l.search},{result:c,isLoading:g}=await se(n),u=(c==null?void 0:c.map((S,W)=>({...S,id:W})))||[];C(!0),I(u==null?void 0:u.length),L(u),p(g)}catch(n){console.error(n)}};return e.jsx(e.Fragment,{children:o?e.jsx(Q,{}):e.jsxs(U,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(ae,{heading:"Monthly report based on new deals created",links:[{name:"Dashboard",href:X.dashboard.root},{name:"Monthly report based on new deals created"}],action:e.jsx(D,{display:"flex",gap:2,children:e.jsx(we,{variant:"contained",startIcon:e.jsx(A,{icon:"solar:export-bold"}),onClick:Y,loading:r,children:"Export"})}),sx:{mb:{xs:3,md:3}}}),e.jsx(P,{filters:l,dateError:a,onFilters:H}),m.length>0?e.jsx(re,{title:"",chart:G}):e.jsx(ne,{title:"No Data"}),m&&x.length>0&&e.jsx(Ae,{sx:{mb:3,marginTop:"30px"},children:e.jsx(ke,{neoAppDataSummaryPercents:x})}),h&&e.jsx(ve,{loading:r,openFile:h,handleClose:V,totalCount:R,tableDataExcel:E})]})})},Ee=Pe;function Wa(){return e.jsxs(e.Fragment,{children:[e.jsx(ee,{children:e.jsx("title",{children:"Neo Verify | Summary"})}),e.jsx(Ee,{})]})}export{Wa as default};
