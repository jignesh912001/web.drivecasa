import{a as H,$ as P,ab as V,c as G,r as n,j as a,m as z,p as M,G as p,S as v,T as O,k as $,H as q}from"./index--wFaadRb.js";import{c as Z,f as _,u as W,F as Y,o as J,w as K}from"./rhf-autocomplete-QnBVLTrH.js";import{C as Q}from"./custom-breadcrumbs-ONDZWUfG.js";import{r as X,u as w}from"./xlsx-_hdJyjoG.js";import{I as ee}from"./neoVerify-GfeAaJ_E.js";import{E as h}from"./Common-aYjtB8FW.js";import{C as ae}from"./Card-3xd7QD08.js";import{C as te}from"./CardHeader-z-utyf17.js";import{L as se}from"./LoadingButton-sQ_fGZmr.js";import"./upload-avatar-D_5IKOg4.js";import"./format-number-3gFJgd2b.js";import"./fade-_k0nGodV.js";import"./image-HS8B2pMt.js";import"./TextField-wUpGdfDy.js";import"./Select-EWNJcv7w.js";import"./index-q81m-9gd.js";import"./Checkbox-BwNFb8VB.js";import"./SwitchBase-Zut6ZoL2.js";import"./Chip-k7nWeOZP.js";import"./FormControlLabel-wG6vzsxy.js";import"./Switch-1lqz2NaP.js";import"./editor-0GqhwI0G.js";import"./Radio-PU2JLskG.js";import"./Autocomplete-xuNfJMJv.js";import"./Close-RAVJ66bT.js";import"./index-_dqGMlRY.js";import"./CircularProgress-HPbgFw1H.js";function j({currentPost:s}){H();const y=P("up","md"),{enqueueSnackbar:m}=V(),D=G(),g=Z().shape({coverUrl:_().nullable().required("You must upload a file!")}),d=n.useMemo(()=>({coverUrl:(s==null?void 0:s.coverUrl)||null}),[s]),b=W({resolver:J(g),defaultValues:d}),{reset:u,watch:F,setValue:c,handleSubmit:C,formState:{isSubmitting:I}}=b;F(),n.useEffect(()=>{s&&u(d)},[s,d,u]);const A=n.useCallback(o=>new Promise((t,r)=>{const i=new FileReader;i.onload=l=>{try{const f=new Uint8Array(l.target.result),S=X(f,{type:"array"}),k=S.SheetNames[0],B=S.Sheets[k],x=w.sheet_to_json(B),L=x==null?void 0:x.map(e=>({appId:e["App Id"]||"",id:e.Id||"",type:e.Type||"",applicationDate:h(e["Application Date"])||null,soldDate:h(e["Sold Date"])||null,combAppSoldDate:h(e["Combined App-Sold Date"])||null,completionTime:e["Completion Time"]||"",dealership:e.Dealership||"",appFirstName:e["Applicant First Name"]||"",appLastName:e["Applicant Last Name"]||"",status:e.Status||"",score:e.Score||"",grade:e.Grade||"",customTag:e["Custom Tag"]||"",approvalTier:e["Approval Tier"]||"",downpayment:e.Downpayment||"",addDp:e["Add DP"]||"",salesperson:e.Salesperson||"",brd:e.BDR||"",brD2:e["BDR 2"]||"",decisionedBy:e["Decisioned By"]||"",verifier:e.Verifier||"",advActionLetter:e["Adverse Action Letter"]||"",notes:e.Notes||"",referralSource:e["Referral Source"]||"",referralSourceDetail:e["Referral Source Detail"]||"",email:e.Email||"",cellNumber:e["Cell Number"]||"",homeNumber:e["Home Number"]||"",paycallTier:e["Paycall Tier"]||"",proofOfIncome:e["Proof of Income"]||"",dmsId:e["DMS Id"]||"",income:e.Income||"",monthlyPayment:e["Monthly Payment"]||"",pti:e.PTI||"",creditScore:e["Credit Score"]||"",repossession:e.Repossession||"",financialReportStatus:e["Financial Report Status"]||"",applicantZipcode:e["Applicant Zipcode"]||"",zipCode:e.zipCode||""}));t(L)}catch(f){r(f)}},i.onerror=l=>r(l),i.readAsArrayBuffer(o)}),[]),R=C(async o=>{try{await new Promise(l=>setTimeout(l,500));const t=await A(o.coverUrl),{status:r,message:i}=await ee(t);r?m("Upload success!"):m(i,{variant:"error"}),D.onFalse(),u()}catch(t){m(t,{variant:"error"}),console.error(t)}}),T=n.useCallback(o=>{const t=o[0],r=Object.assign(t,{preview:URL.createObjectURL(t)});t&&c("coverUrl",r,{shouldValidate:!0})},[c]),U=n.useCallback(()=>{c("coverUrl",null)},[c]),E=a.jsx(p,{xs:12,md:12,children:a.jsxs(ae,{children:[!y&&a.jsx(te,{title:"Details"}),a.jsx(v,{spacing:3,sx:{p:3},children:a.jsxs(v,{spacing:1.5,children:[a.jsx(O,{variant:"subtitle2",children:"Upload File"}),a.jsx(K,{name:"coverUrl",accept:{"text/csv":[],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[],"application/vnd.ms-excel":[]},onDrop:T,onDelete:U})]})})]})}),N=a.jsxs(a.Fragment,{children:[y&&a.jsx(p,{md:4}),a.jsx(p,{xs:12,md:8,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:a.jsx(se,{type:"submit",variant:"contained",size:"large",loading:I,sx:{ml:2},children:"Upload  File"})})]});return a.jsxs(z,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[a.jsx(Q,{heading:"Import Excel",links:[{name:"Dashboard",href:M.dashboard.root},{name:"Import Excel"}],sx:{mb:{xs:3,md:5}}}),a.jsx(Y,{methods:b,onSubmit:R,children:a.jsxs(p,{container:!0,spacing:3,children:[E,N]})})]})}j.propTypes={currentPost:$.object};function Ee(){return a.jsxs(a.Fragment,{children:[a.jsx(q,{children:a.jsx("title",{children:" Neo verify | Import Excel "})}),a.jsx(j,{})]})}export{Ee as default};
