import{k as T,r as o,j as e,S as E,i as y,q as U,G as Z,U as $,T as P,f as k,d as J,e as K,eo as Q,dB as X,dC as ee,ep as ae,eq as te,ej as D,ea as le,m as re,p as se,H as ie}from"./index-Noo6fs27.js";import{C as oe}from"./custom-breadcrumbs-ydG5UHR-.js";import{i as ne}from"./format-time--nxbD8jU.js";import{F as de}from"./file-data-activity-a5wOTCJ8.js";import{a as me,G as fe}from"./neoVerify-0fcui3rK.js";import{D as I}from"./DatePicker-dI5-Uu8W.js";import{f as ce}from"./TextField-R_zrqhUz.js";import{E as pe}from"./empty-content-neEhJRi2.js";import{u as ue}from"./use-table-x52TJGmb.js";import"./table-pagination-custom-31NnKtWK.js";import{T as he,a as xe,d as be,c as Ce,b as w}from"./TableHead-DaGcyC7y.js";import{T as p}from"./TableCell-C_4SG-uK.js";import{a as je,b as De,c as ye,d as Ne,e as ge,f as Se,i as We,j as Me,k as Te,l as we}from"./report-table-row-0icmMln3.js";import{u as A,w as Ae}from"./xlsx-_hdJyjoG.js";import{D as ke}from"./DialogTitle-Ou39CZJS.js";import{B as ve}from"./Button-0u0OGDhY.js";import{D as Pe}from"./DialogContent-leYRYKKd.js";import{D as Ie}from"./DataGrid-A8aJHe0y.js";import{L as Ee}from"./LoadingButton-_b30FxuD.js";import{C as Fe}from"./Card-AWTGDnPA.js";import"./index-q81m-9gd.js";import"./use-chart-ORinRIUO.js";import"./CardHeader-Q5sXuOkK.js";import"./DialogActions-zQcx6p5x.js";import"./ListItem-MzG_70uk.js";import"./isMuiElement--IXscibz.js";import"./Chip-uU-2Hg8I.js";import"./Select-OTUqTT0w.js";import"./Checkbox-8V6d5qf8.js";import"./SwitchBase-npDm6zu2.js";import"./TablePagination-XES-pYGb.js";import"./KeyboardArrowRight-J6vZcRFD.js";import"./FirstPage-4OZx4AEp.js";import"./FormControlLabel-LkDekRFr.js";import"./Switch-1PwF50Ho.js";import"./Box-pDUbXa7t.js";import"./Stack-FuY0od7O.js";import"./dialogTitleClasses-8wWor_1f.js";import"./Autocomplete-OsxNL8sI.js";import"./Close-anbWtQJW.js";import"./ClickAwayListener-N3PeQBgh.js";import"./Skeleton-h1dJsBc1.js";import"./CircularProgress-ofWz8Qe9.js";function F({filters:s,onFilters:n,dateError:t}){const r=o.useCallback(f=>{n("startDate",f)},[n]),u=o.useCallback(f=>{n("endDate",f)},[n]);return e.jsx(e.Fragment,{children:e.jsxs(E,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(I,{label:"Start date",value:s.startDate,onChange:r,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(I,{label:"End date",value:s.endDate,onChange:u,slotProps:{textField:{fullWidth:!0,error:t}},sx:{maxWidth:{md:200},[`& .${ce.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}F.propTypes={dateError:T.bool,filters:T.object,onFilters:T.func};const Le=({neoAppDataSummaryPercents:s})=>{const n=ue();return e.jsx(y,{sx:{width:"100%"},children:e.jsx(U,{children:e.jsx(he,{component:Z,children:e.jsxs(xe,{size:(n.dense,"small"),children:[e.jsx(be,{children:e.jsxs(Ce,{children:[e.jsx(p,{}),s.map((t,r)=>e.jsx(p,{children:t.monthName},r))]})}),e.jsxs(w,{children:[e.jsx(p,{sx:{fontWeight:"bold"},children:"Book To Look"}),s.map((t,r)=>e.jsxs(p,{children:[t.bookToLookPercentage," %"]},r))]}),e.jsxs(w,{children:[e.jsx(p,{sx:{fontWeight:"bold"},children:"Book To Approved"}),s.map((t,r)=>e.jsxs(p,{children:[t.bookToApprovedPercentage," %"]},r))]}),e.jsxs(w,{children:[e.jsx(p,{sx:{fontWeight:"bold"},children:"Approved"}),s.map((t,r)=>e.jsxs(p,{children:[t.approvedPercentage," %"]},r))]})]})})})})},Re=({openFile:s,loading:n,handleClose:t,totalCount:r,tableDataExcel:u})=>{const f=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(je,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(De,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ye,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Ne,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ge,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Se,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(We,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Me,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Te,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(we,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],d=()=>{const a=f.map(b=>b.headerName),N=u.map(b=>f.map(j=>b[j.field])),m=[a,...N],g=A.aoa_to_sheet(m),x=A.book_new();A.book_append_sheet(x,g,"Sheet1"),Ae(x,"Monthly-report.xlsx"),K("Download successful."),t(!1)};return e.jsx(e.Fragment,{children:e.jsxs($,{fullWidth:!0,open:s,onClose:t,PaperProps:{sx:{maxWidth:"100%",maxHeight:800}},children:[e.jsx(ke,{children:e.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(P,{variant:"h6",children:"Preview"}),e.jsxs(y,{sx:{display:"flex",gap:2},children:[e.jsx(ve,{variant:"contained",color:"primary",onClick:d,startIcon:e.jsx(k,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(J,{variant:"solid",sx:{fontWeight:"900"},onClick:t,children:e.jsx(k,{icon:"eva:close-outline"})})]})]})}),e.jsx(Pe,{children:e.jsx(Ie,{rowCount:r,rows:u,columns:f,loading:n,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(E,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(P,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",r]})})]})})},Be={search:"",startDate:Q(),endDate:new Date},Ge=()=>{const s=X(),{user:n}=o.useContext(ee),[t,r]=o.useState(!0),[u,f]=o.useState(!1),[d,a]=o.useState(Be),N=ne(d.startDate,d.endDate),[m,g]=o.useState([]),[x,b]=o.useState(Array),[j,v]=o.useState(!1),[L,R]=o.useState([]),[B,G]=o.useState(0),[S,H]=o.useState({IsAudit:!1,IsExport:!1,IsPrint:!1});o.useEffect(()=>{t&&(Y(),V())},[t]);const V=async()=>{const l={UserTypeID:n==null?void 0:n.UserTypeID},{result:i,status:c}=await ae(l);if(c){let C=te(i,"void : monthly new deals created");H(C)}},Y=async()=>{var h;const l={searchStartDate:D(d.startDate),searchEndDate:D(d.endDate),search:d.search},{result:i,isLoading:c}=await me(l),C=((h=i==null?void 0:i.neoAppDataSummaries)==null?void 0:h.map((W,M)=>({...W,id:M})))||[];b(i==null?void 0:i.neoAppDataSummaryPercents),g(C),r(c)},O=o.useCallback((l,i)=>{a(c=>({...c,[l]:i})),r(!0)},[]),_={labels:m==null?void 0:m.map(l=>[l.monthYear,`Total : ${l.totalApplications}`]),colors:[s.palette.primary.main,s.palette.error.main,s.palette.warning.main,s.palette.text.disabled],series:[{type:"Month",data:[{name:"Funded Sold",data:m.map(l=>l.appsFundedSold)},{name:"Incomplete Applications",data:m.map(l=>l.incompleteApplications)},{name:"Approved Not Sold",data:m.map(l=>l.appsApprovedNotSold)},{name:"Declined",data:m.map(l=>l.appsDeclined)}],options:{}}]},q=()=>{v(!open)},z=async l=>{try{f(!0);const i={searchStartDate:D(d.startDate),searchEndDate:D(d.endDate),search:d.search},{result:c,isLoading:C}=await fe(i),h=(c==null?void 0:c.map((W,M)=>({...W,id:M})))||[];v(!0),G(h==null?void 0:h.length),R(h),f(C)}catch(i){console.error(i)}};return e.jsx(e.Fragment,{children:t?e.jsx(le,{}):e.jsxs(re,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(oe,{heading:"Monthly report based on new deals created",links:[{name:"Dashboard",href:se.dashboard.root},{name:"Monthly report based on new deals created"}],action:e.jsx(y,{display:"flex",gap:2,children:(S==null?void 0:S.IsExport)&&e.jsx(Ee,{variant:"contained",startIcon:e.jsx(k,{icon:"solar:export-bold"}),onClick:z,loading:u,children:"Export"})}),sx:{mb:{xs:3,md:3}}}),e.jsx(F,{filters:d,dateError:N,onFilters:O}),m.length>0?e.jsx(de,{title:"",chart:_}):e.jsx(pe,{title:"No Data"}),m&&x.length>0&&e.jsx(Fe,{sx:{mb:3,marginTop:"30px"},children:e.jsx(Le,{neoAppDataSummaryPercents:x})}),j&&e.jsx(Re,{loading:u,openFile:j,handleClose:q,totalCount:B,tableDataExcel:L})]})})},He=Ge;function va(){return e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:e.jsx("title",{children:"Neo Verify | Monthly report based on new deals created"})}),e.jsx(He,{})]})}export{va as default};
