import{k as W,r as s,j as e,S as k,W as Y,i as g,T as w,q as _,f as M,d as O,e as V,e9 as Z,l as $,d_ as q,m as z,p as J,H as K}from"./index-uVPesBhw.js";import{C as Q}from"./custom-breadcrumbs-Rqwg7UbT.js";import{i as U}from"./format-time-W2DnIC3m.js";import{b as X,f as b}from"./Common-hXss4EbD.js";import{F as ee}from"./file-data-activity-TRJjXMnv.js";import{b as ae,G as te}from"./neoVerify-dNYclPBY.js";import{D as T}from"./DatePicker-ehE_OePY.js";import{f as le}from"./TextField-6Hu2b-ia.js";import{E as ie}from"./empty-content-IdzMNrs-.js";import"./table-pagination-custom-PPf52iAX.js";import{a as re,b as se,c as ne,d as oe,e as de,f as me,i as fe,j as pe,k as ue,l as ce}from"./report-table-row-bMSnWWdg.js";import{u as N,w as he}from"./xlsx-_hdJyjoG.js";import{D as xe}from"./DialogTitle-HqGwd4su.js";import{D as be}from"./DialogContent-jaURAAiw.js";import{D as Ce}from"./DataGrid-SqjhS0VT.js";import{L as De}from"./LoadingButton-27vfNiU5.js";import"./index-q81m-9gd.js";import"./format-number-3EYmo-7I.js";import"./use-chart-KXFQZkdI.js";import"./Card-QTOBqWMl.js";import"./CardHeader-jsaOwpX9.js";import"./index-301W6YuJ.js";import"./DialogActions-iKqfrBTk.js";import"./ListItem-qX3sLXQ6.js";import"./Chip-pgpphWrt.js";import"./Select-h7D7IbQZ.js";import"./TablePagination-scXfEMot.js";import"./KeyboardArrowRight-Lm6xRPbL.js";import"./FirstPage-qArXKF-z.js";import"./Checkbox-vyQH2krq.js";import"./SwitchBase-QymJLNnm.js";import"./FormControlLabel-qE9_3HQs.js";import"./Switch-5dMY5RB3.js";import"./Box-QdQHT0UB.js";import"./Stack-AAES0PXI.js";import"./dialogTitleClasses-p44UBkdB.js";import"./Autocomplete-Zz-xxO4T.js";import"./Close-7VtSoPDS.js";import"./ClickAwayListener-IS6wJeVP.js";import"./Skeleton-ZvW1cRpn.js";import"./CircularProgress-unPeuAqy.js";function v({filters:o,onFilters:n,dateError:d}){const m=s.useCallback(t=>{n("startDate",t)},[n]),f=s.useCallback(t=>{n("endDate",t)},[n]);return e.jsx(e.Fragment,{children:e.jsxs(k,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsx(T,{label:"Start date",value:o.startDate,onChange:m,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(T,{label:"End date",value:o.endDate,onChange:f,slotProps:{textField:{fullWidth:!0,error:d}},sx:{maxWidth:{md:200},[`& .${le.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}})]})})}v.propTypes={dateError:W.bool,filters:W.object,onFilters:W.func};const ye=({openFile:o,loading:n,handleClose:d,totalCount:m,tableDataExcel:f})=>{const t=[{field:"appFirstName",headerName:"FirstName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"appLastName",headerName:"LastName",flex:1,minWidth:180,editable:!1,hideable:!1,filterable:!1},{field:"email",headerName:"Email",flex:1,minWidth:300,editable:!1,hideable:!1,filterable:!1,renderCell:a=>e.jsx(re,{params:a})},{field:"dmsId",headerName:"DmsId",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"cellNumber",headerName:"Number",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(se,{params:a})},{field:"applicationDate",headerName:"Application Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ne,{params:a})},{field:"combAppSoldDate",headerName:"CombAppSold Date",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(oe,{params:a})},{field:"completionTime",headerName:"Completion Time",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(de,{params:a})},{field:"soldDate",headerName:"Sold Date",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(me,{params:a})},{field:"type",headerName:"Type",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"dealership",headerName:"Dealership",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"score",headerName:"Score",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"grade",headerName:"Grade",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"customTag",headerName:"Custom Tag",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"approvalTier",headerName:"ApprovalTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"salesperson",headerName:"Sales person",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"decisionedBy",headerName:"Decisioned",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"verifier",headerName:"Verifier",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"advActionLetter",headerName:"AdvActionLetter",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"referralSource",headerName:"Referral Source",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"referralSourceDetail",headerName:"Referral Source Detail",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0},{field:"homeNumber",headerName:"Home Number",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"paycallTier",headerName:"PaycallTier",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"proofOfIncome",headerName:"ProofOfIncome",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"pti",headerName:"PTI",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"creditScore",headerName:"CreditScore",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"repossession",headerName:"Repossession",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"applicantZipcode",headerName:"Applicant Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"zipCode",headerName:"Zipcode",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0},{field:"income",headerName:"Income",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(fe,{params:a})},{field:"downpayment",headerName:"Downpayment",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(pe,{params:a})},{field:"monthlyPayment",headerName:"Monthly Payment",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ue,{params:a})},{field:"status",headerName:"Status",flex:1,minWidth:120,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(ce,{params:a})},{field:"notes",headerName:"Notes",flex:1,minWidth:180,filterable:!1,disableColumnMenu:!0}],C=()=>{const a=t.map(c=>c.headerName),i=f.map(c=>t.map(x=>c[x.field])),D=[a,...i],A=N.aoa_to_sheet(D),h=N.book_new();N.book_append_sheet(h,A,"Sheet1"),he(h,"Monthly-report.xlsx"),V("Download successful."),d(!1)};return e.jsx(e.Fragment,{children:e.jsxs(Y,{fullWidth:!0,open:o,onClose:d,PaperProps:{sx:{maxWidth:"100%",maxHeight:800}},children:[e.jsx(xe,{children:e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(w,{variant:"h6",children:"Preview"}),e.jsxs(g,{sx:{display:"flex",gap:2},children:[e.jsx(_,{variant:"contained",color:"primary",onClick:C,startIcon:e.jsx(M,{icon:"eva:cloud-download-fill"}),children:"Download"}),e.jsx(O,{variant:"solid",sx:{fontWeight:"900"},onClick:d,children:e.jsx(M,{icon:"eva:close-outline"})})]})]})}),e.jsx(be,{children:e.jsx(Ce,{rowCount:m,rows:f,columns:t,loading:n,pageSizeOptions:[],hideFooterPagination:!0,stickyHeader:!0,disableColumnMenu:!0})}),e.jsx(k,{sx:{p:2,display:"flex",justifyContent:"flex-end",flexDirection:"row"},children:e.jsxs(w,{variant:"body2",sx:{pr:2},children:["1â€“0 of ",m]})})]})})},Se={search:"",startDate:X(),endDate:new Date},je=()=>{const o=Z();$();const[n,d]=s.useState(!0),[m,f]=s.useState(!1),[t,C]=s.useState(Se),a=U(t.startDate,t.endDate),[i,D]=s.useState([]),[A,h]=s.useState(Array),[c,x]=s.useState(!1),[E,F]=s.useState([]),[P,L]=s.useState(0);s.useEffect(()=>{n&&R()},[n]);const R=async()=>{var u;const l={searchStartDate:b(t.startDate),searchEndDate:b(t.endDate),search:t.search},{result:r,isLoading:p}=await ae(l),y=((u=r==null?void 0:r.neoAppDataStatusWiseSummary)==null?void 0:u.map((S,j)=>({...S,id:j})))||[];h(r==null?void 0:r.neoAppDataSummaryPercents),D(y),d(p)},I=s.useCallback((l,r)=>{C(p=>({...p,[l]:r})),d(!0)},[]),B={labels:i==null?void 0:i.map(l=>[l.monthYear,`Total : ${l.totalApplications}`]),colors:[o.palette.primary.main,o.palette.error.main,o.palette.warning.main,o.palette.text.disabled],series:[{type:"Month",data:[{name:"Working Applications",data:i==null?void 0:i.map(l=>l.workingApplications)},{name:"Approved Applications",data:i.map(l=>l.approvedApplications)},{name:"Ignored Application",data:i.map(l=>l.ignoredApplications)},{name:"Rejected Application",data:i.map(l=>l.rejectedApplications)},{name:"Sold Application",data:i.map(l=>l.soldApplications)}],options:{}}]},G=()=>{x(!open)},H=async l=>{try{f(!0);const r={searchStartDate:b(t.startDate),searchEndDate:b(t.endDate),search:t.search},{result:p,isLoading:y}=await te(r),u=(p==null?void 0:p.map((S,j)=>({...S,id:j})))||[];x(!0),L(u==null?void 0:u.length),F(u),f(y)}catch(r){console.error(r)}};return e.jsx(e.Fragment,{children:n?e.jsx(q,{}):e.jsxs(z,{maxWidth:!1,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(Q,{heading:"Monthly Status Wise Summary",links:[{name:"Dashboard",href:J.dashboard.root},{name:"Monthly Status Wise Summary"}],action:e.jsx(g,{display:"flex",gap:2,children:e.jsx(De,{variant:"contained",startIcon:e.jsx(M,{icon:"solar:export-bold"}),onClick:H,loading:m,children:"Export"})}),sx:{mb:{xs:3,md:3}}}),e.jsx(v,{filters:t,dateError:a,onFilters:I}),i.length>0?e.jsx(ee,{title:"",chart:B}):e.jsx(ie,{title:"No Data"}),c&&e.jsx(ye,{loading:m,openFile:c,handleClose:G,totalCount:P,tableDataExcel:E})]})})},We=je;function pa(){return e.jsxs(e.Fragment,{children:[e.jsx(K,{children:e.jsx("title",{children:"Neo Verify | Monthly Status Wise Summary"})}),e.jsx(We,{})]})}export{pa as default};
